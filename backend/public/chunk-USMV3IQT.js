import{a as A}from"./chunk-ZA6DTMJJ.js";import{a as N,b as v,c as O,d as T,e as P,f as B,g as D,h as I,i as k,j as q,k as V,m as G,o as j,p as z,q as H,r as J,s as K,t as L}from"./chunk-4GGTLMQY.js";import{a as F}from"./chunk-SFIQW75N.js";import"./chunk-WXI33M2S.js";import{c as R,f as E}from"./chunk-SP3ND3RW.js";import"./chunk-FZDFYFOH.js";import{Eb as d,Ib as S,Oa as u,aa as c,ca as C,cb as g,d as r,e as h,eb as w,f as _,ib as p,mb as n,nb as m,ob as b,qa as M,ub as y,vb as x}from"./chunk-YNHFQ7LH.js";function Q(e,i){e&1&&(n(0,"mat-error"),d(1,"Review is "),n(2,"strong"),d(3,"required"),m()())}function U(e,i){if(e&1&&g(0,Q,4,0,"mat-error"),e&2){let t=x();p(t.form.controls.review.hasError("required")?0:-1)}}function W(e,i){e&1&&(n(0,"mat-error"),d(1,"Rating is "),n(2,"strong"),d(3,"required"),m()())}function X(e,i){e&1&&(n(0,"mat-error"),d(1,"Rating must be between "),n(2,"strong"),d(3,"1 and 5"),m()())}function Y(e,i){if(e&1&&g(0,W,4,0,"mat-error")(1,X,4,0,"mat-error"),e&2){let t=x();p(t.form.controls.rating.hasError("required")?0:-1),u(),p(t.form.controls.rating.hasError("min")||t.form.controls.rating.hasError("max")?1:-1)}}var pt=(()=>{var i,t,f;let l=class l{constructor(){h(this,i);h(this,t);h(this,f);this.title=c(R),_(this,i,c(A)),_(this,t,c(F)),_(this,f,c(E)),this.form=c(V).nonNullable.group({review:["",v.required],rating:["",[v.required,v.min(1),v.max(5)]]}),this.medication_id=M(""),this.addedBy=null}ngOnInit(){this.medication_id()&&r(this,i).getMedicationById(this.medication_id()).subscribe({next:a=>{a.success&&a.data?this.addedBy=a.data.added_by:r(this,t).error("Failed to fetch medication details")},error:()=>{r(this,t).error("Failed to fetch medication details")}}),this.title.setTitle("Add Review")}addReviewHandler(){if(this.medication_id()&&this.addedBy){let a=this.form.value,s={_id:"",review:a.review,rating:Number(a.rating),by:this.addedBy,date:Date.now()};r(this,i).addMedicationReview(this.medication_id(),s).subscribe({next:o=>{o.success?(r(this,t).success("Review added successfully"),r(this,f).navigate(["/medications","detail",this.medication_id()])):r(this,t).error("Failed to add review, try again.")},error:()=>{r(this,t).error("Failed to add review, try again.")}})}else r(this,t).error("Medication ID or user information is missing")}};i=new WeakMap,t=new WeakMap,f=new WeakMap,l.\u0275fac=function(s){return new(s||l)},l.\u0275cmp=C({type:l,selectors:[["app-add-review"]],inputs:{medication_id:[1,"medication_id"]},standalone:!0,features:[S],decls:10,vars:4,consts:[[1,"wrapper"],[3,"ngSubmit","formGroup"],[1,"input-field"],["matInput","","placeholder","Enter your review","formControlName","review"],["matInput","","type","number","min","1","max","5","placeholder","Enter your rating (1-5)","formControlName","rating"],["mat-flat-button","","color","accent","type","submit",1,"button",3,"disabled"]],template:function(s,o){s&1&&(n(0,"div",0)(1,"form",1),y("ngSubmit",function(){return o.addReviewHandler()}),n(2,"mat-form-field",2),b(3,"textarea",3),g(4,U,1,1),m(),n(5,"mat-form-field",2),b(6,"input",4),g(7,Y,2,2),m(),n(8,"button",5),d(9,"Add Review"),m()()()),s&2&&(u(),w("formGroup",o.form),u(3),p(o.form.controls.review.invalid&&(o.form.controls.review.dirty||o.form.controls.review.touched)?4:-1),u(3),p(o.form.controls.rating.invalid&&(o.form.controls.rating.dirty||o.form.controls.rating.touched)?7:-1),u(),w("disabled",o.form.invalid))},dependencies:[G,P,N,B,O,T,q,k,D,I,z,j,L,K,J,H],styles:[".wrapper[_ngcontent-%COMP%]{width:100vw;height:100%;background:url(/images/form.jpg) no-repeat bottom;background-size:cover;padding-top:28px;display:flex;align-items:center;justify-content:center}form[_ngcontent-%COMP%]{background:#fffc;padding:20px;border-radius:8px;box-shadow:0 0 10px #0000001a;display:flex;flex-direction:column;align-items:center;gap:16px;max-width:500px;width:100%}.input-field[_ngcontent-%COMP%]{width:100%}.input-field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .input-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:16px;padding:10px}button[_ngcontent-%COMP%]{width:100%;padding:10px;border-radius:8px;background-color:#00796b!important;color:#fff;font-size:16px;font-weight:700;border:none;cursor:pointer;transition:background-color .3s ease}button[_ngcontent-%COMP%]:disabled{background-color:#aaa!important}"]});let e=l;return e})();export{pt as AddReviewComponent};
