import{a as J}from"./chunk-NKNGU7ZJ.js";import{b as N}from"./chunk-7MFPINIG.js";import{a as P,b as v,c as D,d as F,e as j,g as q,h as O,k as $,m as U,o as G,p as A,q as B,r as R,s as V,t as H}from"./chunk-4GGTLMQY.js";import{a as T}from"./chunk-SFIQW75N.js";import"./chunk-WXI33M2S.js";import{c as I,f as k}from"./chunk-SP3ND3RW.js";import"./chunk-FZDFYFOH.js";import{Eb as s,Ib as E,Oa as d,aa as f,ca as y,cb as h,d as u,e as _,eb as w,f as S,ib as g,mb as o,nb as l,ob as b,ub as M,vb as x}from"./chunk-YNHFQ7LH.js";var c=class extends Error{};c.prototype.name="InvalidTokenError";function z(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,i)=>{let n=i.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function K(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return z(e)}catch{return atob(e)}}function Y(t,e){if(typeof t!="string")throw new c("Invalid token specified: must be a string");e||(e={});let i=e.header===!0?0:1,n=t.split(".")[i];if(typeof n!="string")throw new c(`Invalid token specified: missing part #${i+1}`);let r;try{r=K(n)}catch(C){throw new c(`Invalid token specified: invalid base64 for part #${i+1} (${C.message})`)}try{return JSON.parse(r)}catch(C){throw new c(`Invalid token specified: invalid json for part #${i+1} (${C.message})`)}}function L(t,e){t&1&&(o(0,"mat-error"),s(1,"Email is "),o(2,"strong"),s(3,"required"),l()())}function Q(t,e){t&1&&(o(0,"mat-error"),s(1,"Please enter a valid email address"),l())}function W(t,e){if(t&1&&h(0,L,4,0,"mat-error")(1,Q,2,0,"mat-error"),t&2){let i=x();g(i.email.hasError("required")?0:-1),d(),g(i.email.hasError("email")?1:-1)}}function X(t,e){t&1&&(o(0,"mat-error"),s(1,"Password is "),o(2,"strong"),s(3,"required"),l()())}function Z(t,e){if(t&1&&(o(0,"div"),h(1,X,4,0,"mat-error"),l()),t&2){let i=x();d(),g(i.password.hasError("required")?1:-1)}}var St=(()=>{var e,i,n;let r=class r{constructor(){_(this,e);_(this,i);_(this,n);this.title=f(I),S(this,e,f(N)),S(this,i,f(T)),S(this,n,f(k)),this.form=f($).nonNullable.group({email:["",[v.required,v.email]],password:["",v.required]}),this.title.setTitle("Sign In")}get email(){return this.form.controls.email}get password(){return this.form.controls.password}signinHandler(){u(this,e).signin(this.form.value).subscribe({next:p=>{if(p.success){let m=Y(p.data);u(this,e).$state.set({_id:m._id,fullname:m.fullname,email:m.email,jwt:p.data}),u(this,i).success("You Successfully Sign in!"),u(this,n).navigate(["","medications","list"])}},error:p=>{u(this,i).error("Invalid Username or Password.")}})}};e=new WeakMap,i=new WeakMap,n=new WeakMap,r.\u0275fac=function(m){return new(m||r)},r.\u0275cmp=y({type:r,selectors:[["app-signin"]],standalone:!0,features:[E],decls:12,vars:4,consts:[[1,"signin-container"],[3,"ngSubmit","formGroup"],["appearance","fill",1,"form-control"],["matInput","","type","text","placeholder","Email","formControlName","email"],["matInput","","type","password","placeholder","Password","formControlName","password"],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(m,a){m&1&&(o(0,"div",0)(1,"form",1),M("ngSubmit",function(){return a.signinHandler()}),o(2,"h2"),s(3,"Sign In"),l(),o(4,"mat-form-field",2),b(5,"input",3),h(6,W,2,2),l(),o(7,"mat-form-field",2),b(8,"input",4),h(9,Z,2,1,"div"),l(),o(10,"button",5),s(11,"Sign In"),l()()()),m&2&&(d(),w("formGroup",a.form),d(5),g(a.email.invalid&&(a.email.dirty||a.email.touched)?6:-1),d(3),g(a.password.invalid&&(a.password.dirty||a.password.touched)?9:-1),d(),w("disabled",a.form.invalid))},dependencies:[U,j,P,D,F,q,O,A,G,H,V,R,B,J],styles:[".signin-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:70vh;background-color:#f7f7f7}.signin-form[_ngcontent-%COMP%]{padding:20px;box-shadow:0 0 10px #0000001a;width:300px;text-align:center}.form-control[_ngcontent-%COMP%]{width:100%;margin-bottom:10px}button[_ngcontent-%COMP%]{width:100%;margin-top:10px;background-color:#00796b!important;color:#fff!important}button[_ngcontent-%COMP%]:disabled{background-color:#aaa!important}"]});let t=r;return t})();export{St as SigninComponent};
