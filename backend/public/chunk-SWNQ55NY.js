import{a as q}from"./chunk-ZA6DTMJJ.js";import{a as O,b as C,c as P,d as I,e as V,g as w,h as D,k as G,l as A,m as B,o as $,p as k,q as R,r as j,s as z,t as L}from"./chunk-4GGTLMQY.js";import{a as N}from"./chunk-SFIQW75N.js";import"./chunk-WXI33M2S.js";import{f as T}from"./chunk-SP3ND3RW.js";import"./chunk-FZDFYFOH.js";import{Eb as d,Ib as U,Oa as p,Za as E,aa as _,ca as M,cb as c,d as s,e as v,eb as x,f as b,ib as m,jc as F,mb as i,nb as l,ob as g,qa as S,ub as y,vb as h}from"./chunk-YNHFQ7LH.js";function K(e,n){e&1&&(i(0,"mat-error"),d(1,"Name is "),i(2,"strong"),d(3,"required"),l()())}function Q(e,n){if(e&1&&c(0,K,4,0,"mat-error"),e&2){let a=h();m(a.name.hasError("required")?0:-1)}}function W(e,n){e&1&&(i(0,"mat-error"),d(1,"Generic name is "),i(2,"strong"),d(3,"required"),l()())}function X(e,n){if(e&1&&c(0,W,4,0,"mat-error"),e&2){let a=h();m(a.generic_name.hasError("required")?0:-1)}}function Y(e,n){e&1&&(i(0,"mat-error"),d(1,"Medication class is "),i(2,"strong"),d(3,"required"),l()())}function Z(e,n){if(e&1&&c(0,Y,4,0,"mat-error"),e&2){let a=h();m(a.medication_class.hasError("required")?0:-1)}}function ee(e,n){e&1&&(i(0,"mat-error"),d(1,"Availability is "),i(2,"strong"),d(3,"required"),l()())}function te(e,n){e&1&&(i(0,"mat-error"),d(1,"Please enter "),i(2,"strong"),d(3,"Prescription or OTC"),l()())}function ie(e,n){if(e&1&&c(0,ee,4,0,"mat-error")(1,te,4,0,"mat-error"),e&2){let a=h();m(a.availability.hasError("required")?0:-1),p(),m(a.availability.hasError("invalidAvailability")?1:-1)}}var Ce=(()=>{var n,a,u;let f=class f{constructor(){v(this,n);v(this,a);v(this,u);b(this,n,_(q)),b(this,a,_(T)),this.medication_id=S(""),this.medication$=E(null),b(this,u,_(N)),this.form=_(G).nonNullable.group({name:["",C.required],generic_name:["",C.required],availability:["",[C.required,this.availabilityValidator()]],medication_class:["",C.required]})}get name(){return this.form.controls.name}get generic_name(){return this.form.controls.generic_name}get availability(){return this.form.controls.availability}get medication_class(){return this.form.controls.medication_class}ngOnInit(){this.medication_id&&s(this,n).getMedicationById(this.medication_id()).subscribe({next:o=>{this.medication$.set(o.data),this.form.patchValue(o.data)},error:o=>{console.error("Error fetching medication:",o),s(this,a).navigate(["/medications","list"])}})}onFileChange(o){let r=o.target;r.files.length>0&&(this.file=r.files[0])}updateMedication(){if(this.form.valid&&this.medication$()){let o=this.form.value,r=new FormData;r.append("name",o.name),r.append("generic_name",o.generic_name),r.append("medication_class",o.medication_class),r.append("availability",o.availability),this.file&&r.append("medication_image",this.file),s(this,n).updateMedicationById(r,this.medication$()._id).subscribe({next:t=>{t.success?(s(this,u).success("Medication Updated Successfully!"),s(this,a).navigate(["/medications","list"])):s(this,u).error("Failed to Update Medication")},error:t=>{console.error("Error updating medication:",t),s(this,u).error("Failed to Update Medication")}})}}availabilityValidator(){return o=>["Prescription","OTC"].includes(o.value)?null:{invalidAvailability:!0}}};n=new WeakMap,a=new WeakMap,u=new WeakMap,f.\u0275fac=function(r){return new(r||f)},f.\u0275cmp=M({type:f,selectors:[["app-update"]],inputs:{medication_id:[1,"medication_id"]},standalone:!0,features:[U],decls:19,vars:6,consts:[[1,"update-container"],[3,"ngSubmit","formGroup"],[1,"input-field"],["matInput","","placeholder","Name","formControlName","name"],["matInput","","placeholder","Generic Name","formControlName","generic_name"],["matInput","","placeholder","Medication Class","formControlName","medication_class"],["matInput","","placeholder","Availability","formControlName","availability"],["type","file",3,"change"],["mat-flat-button","","color","accent","type","submit",3,"disabled"]],template:function(r,t){r&1&&(i(0,"div",0)(1,"h1"),d(2,"Update Medication"),l(),i(3,"form",1),y("ngSubmit",function(){return t.updateMedication()}),i(4,"mat-form-field",2),g(5,"input",3),c(6,Q,1,1),l(),i(7,"mat-form-field",2),g(8,"input",4),c(9,X,1,1),l(),i(10,"mat-form-field",2),g(11,"input",5),c(12,Z,1,1),l(),i(13,"mat-form-field",2),g(14,"input",6),c(15,ie,2,2),l(),i(16,"input",7),y("change",function(J){return t.onFileChange(J)}),l(),i(17,"button",8),d(18,"Update"),l()()()),r&2&&(p(3),x("formGroup",t.form),p(3),m(t.name.invalid&&(t.name.dirty||t.name.touched)?6:-1),p(3),m(t.generic_name.invalid&&(t.generic_name.dirty||t.generic_name.touched)?9:-1),p(3),m(t.medication_class.invalid&&(t.medication_class.dirty||t.medication_class.touched)?12:-1),p(3),m(t.availability.invalid&&(t.availability.dirty||t.availability.touched)?15:-1),p(2),x("disabled",t.form.invalid))},dependencies:[F,A,V,O,P,I,B,w,D,k,$,L,z,j,R],styles:[".update-container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto;padding:20px;border:1px solid #ddd;border-radius:4px;box-shadow:0 0 10px #0000001a}h1[_ngcontent-%COMP%]{text-align:center;color:#00796b}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.input-field[_ngcontent-%COMP%]{width:100%}input[type=file][_ngcontent-%COMP%]{margin:10px 0}button[_ngcontent-%COMP%]{width:100%;padding:10px;background-color:#00796b!important;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:16px}button[_ngcontent-%COMP%]:disabled{background-color:#aaa!important}"]});let e=f;return e})();export{Ce as UpdateComponent};
